const examples = {
    "Phishing Prevention": [
        {
            title: "Phishtank",
            imageUrl: "./assets/imgs/phishtank.png",
            description: "A community-driven website that tracks and verifies phishing scams. Users can report and verify suspicious emails or links.",
            link: "https://phishtank.org/",
        },
    ],
    "Password Generator": [
        {
            title: "Avast Password Generator",
            imageUrl: "./assets/imgs/avast_password_generator.png",
            description: "It is a user-friendly tool that creates strong, unique passwords for your online accounts, enhancing security by making it difficult for hackers to access your personal information.",
            link: "https://www.avast.com/en-us/random-password-generator#pc",
        },
        {
            title: "Trend Micro Password Generator",
            imageUrl: "./assets/imgs/trendmicro_password_generator.png",
            description: "It is a user-friendly tool that creates strong and secure passwords for your accounts. It helps protect your online information by generating complex passwords that are difficult for hackers to crack.",
            link: "https://idprotect.trendmicro.com/vault/tool/password-generator",
        }
    ],
    "Help with Ransomware": [
        {
            title: "No More Ransom",
            imageUrl: "./assets/imgs/nomoreransom.png",
            description: "NoMoreRansom.org is a helpful website that offers free tools to unlock your files if they get locked by ransomware. It also shares tips to keep your digital life secure.",
            link: "https://www.nomoreransom.org/en/index.html",
        },
    ],
    "Website Safety Check": [
        {
            title: "URLScan.io",
            imageUrl: "./assets/imgs/urlscan.png",
            description: "This service allows you to scan and analyze websites for potential threats, including phishing and malware.",
            link: "https://urlscan.io/",
        },
        {
            title: "Virustotal",
            imageUrl: "./assets/imgs/virustotal.png",
            description: "VirusTotal is a user-friendly online tool that scans files and URLs for potential threats. It analyzes them using multiple antivirus engines, giving you a comprehensive view of their safety status.",
            link: "https://www.virustotal.com/gui/home/upload",
        },
    ],
    "Credentials Safety Check": [
        {
            title: "Have I been Pwned",
            imageUrl: "./assets/imgs/haveibeenpwned.png",
            description: "Check if your email address or passwords have been compromised in data breaches to enhance your online security.",
            link: "https://haveibeenpwned.com/",
        },
        {
            title: "Trend Micro Password Check",
            imageUrl: "./assets/imgs/trendmicro_password_check.png",
            description: "It is a tool that assesses the strength and security of your passwords. It helps you determine if your passwords are strong enough to protect your online accounts from potential threats and suggests improvements if needed.",
            link: "https://idprotect.trendmicro.com/vault/tool/password-check",
        },
    ],
    "Fake Videos Check": [
        {
            title: "Scan & Detect Deepfake Videos",
            imageUrl: "./assets/imgs/deepware.png",
            description: "Deepfake videos are digitally manipulated videos that use artificial intelligence to replace one person's likeness with another's, often leading to misleading or fraudulent content. Deepware.ai offer a solution for identifying such videos and determining if they have been synthetically manipulated.",
            link: "https://deepware.ai/",
        },
    ],
    "Prevent sharing intimate images": [
        {
            title: "Take It Down",
            imageUrl: "./assets/imgs/takeitdown.png",
            description: "is a service that helps people remove sexually explicit images of themselves as minors from the internet. The service was launched by the National Center for Missing and Exploited Children (NCMEC). It's funded by Meta, the parent company of Facebook.",
            link: "https://takeitdown.ncmec.org/",
        },
        {
            title: "StopNCII.org",
            imageUrl: "./assets/imgs/stopncii.png",
            description: "StopNCII.org, run by the Revenge Porn Helpline, helps stop people from sharing intimate pictures without permission. They use smart technology to keep individuals safe online and have removed many such images from the internet.",
            link: "https://stopncii.org/",
        },
        {
            title: "Revenge Porn Helpline",
            imageUrl: "./assets/imgs/revengepornhelpline.png",
            description: "Coinciding with the introduction of legislation against non-consensual sharing of private sexual content. Run by a passionate team, they provide assistance and advice for those affected by intimate image abuse, with significant success in content removal.",
            link: "https://revengepornhelpline.org.uk/how-can-we-help/if-we-can-t-help-who-can/help-for-victims-outside-the-uk/",
        },
        {
            title: "Cyber Civil Rights Initiative",
            imageUrl: "./assets/imgs/ccri.png",
            description: "CCRI combats online actions that threaten people's basic rights, like privacy and freedom of expression. They aim to help people to end Image-based Sexual Abuse.",
            link: "https://cybercivilrights.org/",
        }
    ],
    "Image Search": [
        {
            title: "TinEye",
            imageUrl: "./assets/imgs/tineye.png",
            description: "TinEye allows you to upload an image and find instances of its use across the web. It's particularly useful for tracking the usage of images.",
            link: "https://tineye.com/",
        },
    ],
    "Search for Scams": [
        {
            title: "BBB Scam Tracker",
            imageUrl: "./assets/imgs/scamtracker.png",
            description: "It provides valuable information to the public about various types of scams, trends in fraudulent activities, and tips on how to avoid falling victim to scams.",
            link: "https://www.bbb.org/scamtracker",
        },
        {
            title: "ScamAdvisor",
            imageUrl: "./assets/imgs/scamadvisor.png",
            description: "It provides valuable information to the public about various types of scams, trends in fraudulent activities, and tips on how to avoid falling victim to scams.",
            link: "https://www.scamadviser.com/",
        },
        {
            title: "Scamwatch (Australia)",
            imageUrl: "./assets/imgs/scamwatch.png",
            description: "This government website provides information about current scams and tips to avoid falling victim to them.",
            link: "https://www.scamwatch.gov.au/",
        },
    ],
    "Patent Security": [
        {
            title: "World Intellectual Property Organization",
            imageUrl: "./assets/imgs/wipo.png",
            description: "WIPO, is a United Nations agency dedicated to managing and safeguarding intellectual property rights globally, including patents, trademarks, and copyrights.",
            link: "https://www.wipo.int/portal/en/index.html",
        },
    ],
    "Fight Against Cybercrime":[
        {
            title: "Cybercrime Support Network",
            imageUrl: "./assets/imgs/fightcybercrime.png",
            description: "The Cybercrime Support Network is an organization that assists individuals and businesses affected by cybercrime. They provide support, resources, and guidance to help victims navigate the aftermath of cybercrimes and recover from the impact.",
            link: "https://fightcybercrime.org/",
        },
        {
            title: "National Cyber Security Alliance",
            imageUrl: "./assets/imgs/staysafeonline.png",
            description: "NCSA is a non-profit organization that promotes and educates people about safe and secure online practices, helping to protect individuals and businesses from cyber threats.",
            link: "https://staysafeonline.org/",
        }
    ]
};


const categoryDropdown = document.getElementById("category");
const searchInput = document.getElementById("search");
const contentSection = document.getElementById("content");

// Set the default value of the category dropdown to "all"
categoryDropdown.value = "all";

// Function to display all contents
function displayAllContents() {
    contentSection.innerHTML = "";
    // Iterate through all categories and display their contents
    Object.values(examples).flat().forEach(function (card) {
        contentSection.innerHTML += `
            <div class="card">
                <img src="${card.imageUrl}" alt="${card.title}">
                <div class="card-content">
                    <a href="${card.link}" target="_blank" class="external-link" data-redirect-url="${card.link}">
                        <div class="card-title">${card.title}</div>
                        <p>${card.description}</p>
                    </a>
                </div>
            </div>
        `;
    });
    // Update the result message
    updateResultMessage("all", "");
}

// Call the function to display all contents when the page loads
displayAllContents();


// redirectLink popup

function startTimerAndRedirect(redirectUrl, websiteName) {
    const popupOverlay = document.getElementById("popupOverlay");
    const popupContainer = document.getElementById("popupContainer");
    const redirectWebsite = document.getElementById("redirectWebsite");
    const popupSeconds = document.getElementById("popupSeconds");
    const redirectLink = document.getElementById("redirectLink");

    let countdown = 10;
    let timer;

    // Update popup content
    redirectWebsite.textContent = websiteName;
    redirectLink.href = redirectUrl;

    // Show the popup
    popupOverlay.style.display = "block";
    popupContainer.style.display = "block";

    // Countdown timer
    timer = setInterval(() => {
        popupSeconds.textContent = countdown;
        if (countdown === 0) {
            clearInterval(timer);
            window.open(redirectUrl, "_blank"); // Redirect to the link
            closePopup(); // Hide the popup
        }
        countdown--;
    }, 1000);

    // Function to close the popup and cancel redirection
    function closePopup() {
        clearInterval(timer); // Stop the countdown
        popupOverlay.style.display = "none";
        popupContainer.style.display = "none";
    }

    // Close popup when clicking outside of it
    popupOverlay.addEventListener("click", (event) => {
        if (event.target === popupOverlay) {
            closePopup(); // Close popup and cancel redirection
        }
    });
}


// Rebind event listeners after content is dynamically updated
function rebindClickListeners() {
    const externalLinks = document.querySelectorAll(".external-link");
    externalLinks.forEach(link => {
        link.addEventListener("click", (event) => {
            event.preventDefault();
            const redirectUrl = link.getAttribute("data-redirect-url");
            const websiteName = link.querySelector(".card-title").textContent;
            startTimerAndRedirect(redirectUrl, websiteName);
        });
    });
}

// Call `rebindClickListeners` after dynamic content is rendered
rebindClickListeners();



// Handle category dropdown change
categoryDropdown.addEventListener("change", function () {
    const selectedCategory = categoryDropdown.value;
    const cards = examples[selectedCategory];

    // Clear previous cards
    contentSection.innerHTML = "";

    if (selectedCategory === "all") {
        // Display all contents
        displayAllContents();
    } else {
        // Display cards for the selected category
        cards.forEach(function (card) {
            contentSection.innerHTML += `
                <div class="card">
                    <img src="${card.imageUrl}" alt="${card.title}">
                    <div class="card-content">
                        <a href="${card.link}" target="_blank" class="external-link" data-redirect-url="${card.link}">
                            <div class="card-title">${card.title}</div>
                            <p>${card.description}</p>
                        </a>
                    </div>
                </div>
            `;
        });
    }

    // Update the result message
    updateResultMessage(selectedCategory, "");

    // Add click event listeners to the new links
    const externalLinks = document.querySelectorAll('.external-link');
    addClickEventListenersToLinks(externalLinks);
});

// Handle form submission
document.querySelector(".searchbar-form").addEventListener("submit", function (e) {
    e.preventDefault();

    const selectedCategory = categoryDropdown.value;
    const searchTerm = searchInput.value.toLowerCase();
    let results = [];

    // Iterate through all categories
    Object.values(examples).flat().forEach(function (card) {
        // Check if the example matches the selected category or search term
        if (
            (selectedCategory === "all" || selectedCategory === card.title) &&
            (searchTerm === "" || card.title.toLowerCase().includes(searchTerm))
        ) {
            results.push(card);
        }
    });

    // Display the filtered cards
    contentSection.innerHTML = "";
    results.forEach(function (card) {
        contentSection.innerHTML += `
            <div class="card">
                <img src="${card.imageUrl}" alt="${card.title}">
                <div class="card-content">
                    <a href="${card.link}" target="_blank" class="external-link" data-redirect-url="${card.link}">
                        <div class="card-title">${card.title}</div>
                        <p>${card.description}</p>
                    </a>
                </div>
            </div>
        `;
    });

    // Update the result message
    updateResultMessage(selectedCategory, searchTerm);
});

// Function to update the result message
function updateResultMessage(category, search) {
    let message = "Showing the result of ";

    if (search !== "") {
        message = `<strong>${message}</strong>` + `<strong>search: </strong>"${search}"`;
    } else {
        if (category !== "all") {
            message = `<strong>${message}</strong>` + `"${category}"`;
        } else {
            message = `<strong>${message}</strong>` + '"All Categories"';
        }
    }

    resultMessage.innerHTML = message;
}